{"openapi":"3.1.0","info":{"title":"Surface Generation API","description":"API for processing LiDAR point cloud files and generating surface breaklines","version":"1.0.0"},"paths":{"/api/v1/upload/":{"post":{"tags":["Upload"],"summary":"Upload files for processing","description":"Upload one or more LAS/LAZ files for processing","operationId":"upload_files_api_v1_upload__post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_files_api_v1_upload__post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UploadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/upload/validate":{"post":{"tags":["Upload"],"summary":"Validate files without uploading","description":"Check if files are valid for processing","operationId":"validate_files_api_v1_upload_validate_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_validate_files_api_v1_upload_validate_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}":{"get":{"tags":["Jobs"],"summary":"Get job status","description":"Get the current status and details of a processing job","operationId":"get_job_status_api_v1_jobs__job_id__get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Jobs"],"summary":"Cancel a job","description":"Cancel a queued or processing job","operationId":"cancel_job_api_v1_jobs__job_id__delete","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/":{"get":{"tags":["Jobs"],"summary":"List jobs","description":"List processing jobs with optional filtering","operationId":"list_jobs_api_v1_jobs__get","parameters":[{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/JobStatus"},{"type":"null"}],"description":"Filter by job status","title":"Status"},"description":"Filter by job status"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Items per page","default":20,"title":"Page Size"},"description":"Items per page"},{"name":"days_back","in":"query","required":false,"schema":{"type":"integer","maximum":30,"minimum":1,"description":"Days to look back","default":7,"title":"Days Back"},"description":"Days to look back"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/retry":{"post":{"tags":["Jobs"],"summary":"Retry a failed job","description":"Retry a failed job with the same parameters","operationId":"retry_job_api_v1_jobs__job_id__retry_post","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/preview":{"get":{"tags":["Jobs"],"summary":"Get job data preview","description":"Get preview of first 50 points in PNEZD format with comprehensive statistics","operationId":"get_job_preview_api_v1_jobs__job_id__preview_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/JobPreviewResponse"},{"$ref":"#/components/schemas/MultiFilePreviewResponse"}],"title":"Response Get Job Preview Api V1 Jobs  Job Id  Preview Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/download/{job_id}":{"get":{"tags":["Download"],"summary":"Get download URLs","description":"Get download URLs for completed job outputs","operationId":"get_download_urls_api_v1_download__job_id__get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"expiry_hours","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Expiry Hours"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DownloadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/download/{job_id}/{filename}":{"get":{"tags":["Download"],"summary":"Download a specific file","description":"Download a specific output file directly","operationId":"download_file_api_v1_download__job_id___filename__get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"filename","in":"path","required":true,"schema":{"type":"string","title":"Filename"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/download/{job_id}/all":{"get":{"tags":["Download"],"summary":"Download all files as ZIP","description":"Download all output files as a ZIP archive (not implemented)","operationId":"download_all_files_api_v1_download__job_id__all_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/health/":{"get":{"tags":["Health"],"summary":"Health check","description":"Check the health status of the API and its dependencies","operationId":"health_check_api_v1_health__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/api/v1/health/ready":{"get":{"tags":["Health"],"summary":"Readiness check","description":"Check if the API is ready to handle requests","operationId":"readiness_check_api_v1_health_ready_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/health/live":{"get":{"tags":["Health"],"summary":"Liveness check","description":"Check if the API is alive","operationId":"liveness_check_api_v1_health_live_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_upload_files_api_v1_upload__post":{"properties":{"files":{"items":{"type":"string","format":"binary"},"type":"array","title":"Files","description":"LAS/LAZ files to process"},"voxel_size":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":1.0},{"type":"null"}],"title":"Voxel Size"},"threshold":{"anyOf":[{"type":"number","maximum":5.0,"minimum":0.1},{"type":"null"}],"title":"Threshold"},"nth_point":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":1.0},{"type":"null"}],"title":"Nth Point"},"source_epsg":{"anyOf":[{"type":"integer","maximum":99999.0,"minimum":1000.0},{"type":"null"}],"title":"Source Epsg"},"target_epsg":{"anyOf":[{"type":"integer","maximum":99999.0,"minimum":1000.0},{"type":"null"}],"title":"Target Epsg"},"output_formats":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Output Formats","description":"Comma-separated list: dxf,csv"},"merge_outputs":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Merge Outputs","default":false},"merged_output_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Merged Output Name"}},"type":"object","required":["files"],"title":"Body_upload_files_api_v1_upload__post"},"Body_validate_files_api_v1_upload_validate_post":{"properties":{"files":{"items":{"type":"string","format":"binary"},"type":"array","title":"Files","description":"Files to validate"}},"type":"object","required":["files"],"title":"Body_validate_files_api_v1_upload_validate_post"},"BoundingBox":{"properties":{"min_northing":{"type":"number","title":"Min Northing"},"max_northing":{"type":"number","title":"Max Northing"},"min_easting":{"type":"number","title":"Min Easting"},"max_easting":{"type":"number","title":"Max Easting"},"min_elevation":{"type":"number","title":"Min Elevation"},"max_elevation":{"type":"number","title":"Max Elevation"}},"type":"object","required":["min_northing","max_northing","min_easting","max_easting","min_elevation","max_elevation"],"title":"BoundingBox","description":"Spatial bounding box"},"ClassificationCount":{"properties":{"code":{"type":"integer","title":"Code"},"name":{"type":"string","title":"Name"},"count":{"type":"integer","title":"Count"},"percentage":{"type":"number","title":"Percentage"}},"type":"object","required":["code","name","count","percentage"],"title":"ClassificationCount","description":"Point classification count"},"DataQuality":{"properties":{"total_points":{"type":"integer","title":"Total Points"},"classifications":{"items":{"$ref":"#/components/schemas/ClassificationCount"},"type":"array","title":"Classifications"},"return_types":{"anyOf":[{"additionalProperties":{"type":"integer"},"type":"object"},{"type":"null"}],"title":"Return Types"},"gps_time_range":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Gps Time Range"},"intensity_stats":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Intensity Stats"}},"type":"object","required":["total_points","classifications"],"title":"DataQuality","description":"Data quality metrics"},"DownloadResponse":{"properties":{"job_id":{"type":"string","title":"Job Id","description":"Job identifier"},"download_urls":{"additionalProperties":{"type":"string"},"type":"object","title":"Download Urls","description":"Map of filename to download URL"},"expires_at":{"type":"string","format":"date-time","title":"Expires At","description":"URL expiration time"}},"type":"object","required":["job_id","download_urls","expires_at"],"title":"DownloadResponse","description":"Response model for file download","example":{"download_urls":{"terrain.csv":"https://storage.blob.core.windows.net/...","terrain.dxf":"https://storage.blob.core.windows.net/..."},"expires_at":"2024-01-01T13:00:00Z","job_id":"123e4567-e89b-12d3-a456-426614174000"}},"ElevationStatistics":{"properties":{"min":{"type":"number","title":"Min","description":"Minimum elevation"},"q1":{"type":"number","title":"Q1","description":"First quartile (25th percentile)"},"median":{"type":"number","title":"Median","description":"Median elevation (50th percentile)"},"q3":{"type":"number","title":"Q3","description":"Third quartile (75th percentile)"},"max":{"type":"number","title":"Max","description":"Maximum elevation"},"mean":{"type":"number","title":"Mean","description":"Mean elevation"},"std_dev":{"type":"number","title":"Std Dev","description":"Standard deviation"},"variance":{"type":"number","title":"Variance","description":"Variance"},"range":{"type":"number","title":"Range","description":"Elevation range (max - min)"},"iqr":{"type":"number","title":"Iqr","description":"Interquartile range (Q3 - Q1)"}},"type":"object","required":["min","q1","median","q3","max","mean","std_dev","variance","range","iqr"],"title":"ElevationStatistics","description":"Elevation statistical summary"},"FileMetadata":{"properties":{"filename":{"type":"string","title":"Filename"},"file_size_mb":{"type":"number","title":"File Size Mb"},"las_version":{"type":"string","title":"Las Version"},"point_data_format":{"type":"integer","title":"Point Data Format"},"creation_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Creation Date"},"generating_software":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Generating Software"},"system_identifier":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"System Identifier"}},"type":"object","required":["filename","file_size_mb","las_version","point_data_format"],"title":"FileMetadata","description":"LAS/LAZ file metadata"},"FilePreview":{"properties":{"preview_points":{"items":{"$ref":"#/components/schemas/PNEZDPoint"},"type":"array","title":"Preview Points"},"elevation_statistics":{"$ref":"#/components/schemas/ElevationStatistics"},"spatial_coverage":{"$ref":"#/components/schemas/SpatialCoverage"},"data_quality":{"$ref":"#/components/schemas/DataQuality"},"file_metadata":{"$ref":"#/components/schemas/FileMetadata"}},"type":"object","required":["preview_points","elevation_statistics","spatial_coverage","data_quality","file_metadata"],"title":"FilePreview","description":"Preview data for a single file"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Service status"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp","description":"Check timestamp"},"version":{"type":"string","title":"Version","description":"API version"},"services":{"additionalProperties":{"type":"boolean"},"type":"object","title":"Services","description":"Service availability"}},"type":"object","required":["status","version","services"],"title":"HealthResponse","description":"Health check response","example":{"services":{"azure_storage":true,"azure_tables":true,"processor":true},"status":"healthy","timestamp":"2024-01-01T12:00:00Z","version":"1.0.0"}},"JobListResponse":{"properties":{"jobs":{"items":{"$ref":"#/components/schemas/JobStatusResponse"},"type":"array","title":"Jobs","description":"List of jobs"},"total":{"type":"integer","title":"Total","description":"Total number of jobs"},"page":{"type":"integer","title":"Page","description":"Current page","default":1},"page_size":{"type":"integer","title":"Page Size","description":"Items per page","default":20}},"type":"object","required":["jobs","total"],"title":"JobListResponse","description":"Response for listing jobs","example":{"jobs":[{"created_at":"2024-01-01T12:00:00Z","input_files":["terrain.las"],"job_id":"123e4567-e89b-12d3-a456-426614174000","status":"completed"}],"page":1,"page_size":20,"total":1}},"JobPreviewResponse":{"properties":{"job_id":{"type":"string","title":"Job Id"},"preview_points":{"items":{"$ref":"#/components/schemas/PNEZDPoint"},"type":"array","title":"Preview Points"},"elevation_statistics":{"$ref":"#/components/schemas/ElevationStatistics"},"spatial_coverage":{"$ref":"#/components/schemas/SpatialCoverage"},"data_quality":{"$ref":"#/components/schemas/DataQuality"},"file_metadata":{"$ref":"#/components/schemas/FileMetadata"},"processing_time_ms":{"type":"number","title":"Processing Time Ms"}},"type":"object","required":["job_id","preview_points","elevation_statistics","spatial_coverage","data_quality","file_metadata","processing_time_ms"],"title":"JobPreviewResponse","description":"Complete preview response for a job"},"JobStatus":{"type":"string","enum":["queued","processing","completed","failed","deleted"],"title":"JobStatus","description":"Job status enumeration"},"JobStatusResponse":{"properties":{"job_id":{"type":"string","title":"Job Id","description":"Unique job identifier"},"status":{"allOf":[{"$ref":"#/components/schemas/JobStatus"}],"description":"Current job status"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Job creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"completed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Completed At","description":"Completion timestamp"},"progress":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Progress","description":"Progress percentage (0-100)"},"input_files":{"items":{"type":"string"},"type":"array","title":"Input Files","description":"Input file names"},"output_files":{"items":{"type":"string"},"type":"array","title":"Output Files","description":"Output file names"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"Error message if failed"}},"type":"object","required":["job_id","status","created_at","updated_at","input_files"],"title":"JobStatusResponse","description":"Response model for job status query","example":{"completed_at":"2024-01-01T12:05:00Z","created_at":"2024-01-01T12:00:00Z","input_files":["terrain.las"],"job_id":"123e4567-e89b-12d3-a456-426614174000","output_files":["terrain.dxf","terrain.csv"],"progress":100.0,"status":"completed","updated_at":"2024-01-01T12:05:00Z"}},"MultiFilePreviewResponse":{"properties":{"job_id":{"type":"string","title":"Job Id"},"is_merge_job":{"type":"boolean","title":"Is Merge Job"},"file_count":{"type":"integer","title":"File Count"},"file_previews":{"items":{"$ref":"#/components/schemas/FilePreview"},"type":"array","title":"File Previews"},"merged_preview":{"anyOf":[{"$ref":"#/components/schemas/FilePreview"},{"type":"null"}],"description":"Preview of merged data (for merge jobs)"},"processing_time_ms":{"type":"number","title":"Processing Time Ms"}},"type":"object","required":["job_id","is_merge_job","file_count","file_previews","processing_time_ms"],"title":"MultiFilePreviewResponse","description":"Preview response for jobs with multiple files"},"PNEZDPoint":{"properties":{"point":{"type":"integer","title":"Point","description":"Point number"},"northing":{"type":"number","title":"Northing","description":"Northing (Y) coordinate rounded to 4 decimals"},"easting":{"type":"number","title":"Easting","description":"Easting (X) coordinate rounded to 4 decimals"},"elevation":{"type":"number","title":"Elevation","description":"Elevation (Z) coordinate rounded to 4 decimals"},"description":{"type":"string","title":"Description","description":"Point classification description"}},"type":"object","required":["point","northing","easting","elevation","description"],"title":"PNEZDPoint","description":"PNEZD format point data"},"SpatialCoverage":{"properties":{"bounding_box":{"$ref":"#/components/schemas/BoundingBox"},"area_sq_meters":{"type":"number","title":"Area Sq Meters"},"area_acres":{"type":"number","title":"Area Acres"},"area_hectares":{"type":"number","title":"Area Hectares"},"point_density":{"type":"number","title":"Point Density","description":"Points per square meter"},"coordinate_system":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Coordinate System","description":"EPSG code or coordinate system name"}},"type":"object","required":["bounding_box","area_sq_meters","area_acres","area_hectares","point_density"],"title":"SpatialCoverage","description":"Spatial coverage information"},"UploadResponse":{"properties":{"job_id":{"type":"string","title":"Job Id","description":"Unique job identifier"},"status":{"allOf":[{"$ref":"#/components/schemas/JobStatus"}],"description":"Initial job status"},"message":{"type":"string","title":"Message","description":"Status message"},"files_uploaded":{"type":"integer","title":"Files Uploaded","description":"Number of files uploaded"}},"type":"object","required":["job_id","status","message","files_uploaded"],"title":"UploadResponse","description":"Response model for file upload","example":{"files_uploaded":2,"job_id":"123e4567-e89b-12d3-a456-426614174000","message":"Files uploaded successfully. Processing will begin shortly.","status":"queued"}},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}